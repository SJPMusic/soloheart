# SoloHeart Project Structure

This rule outlines the directory structure and organization of the SoloHeart project - an immersive solo narrative adventure platform built with Python, Flask, and The Narrative Engine.

## Project Overview

**SoloHeart** is a comprehensive narrative adventure platform that provides:
- Interactive solo narrative experiences
- Advanced character creation and development
- Modular Narrative Engine for story continuity
- Persistent memory and campaign management
- Web-based interface for immersive storytelling

## Root Directory Structure

```
SoloHeart/
â”œâ”€â”€ solo_heart/           # ðŸŽ® Main SoloHeart application
â”œâ”€â”€ narrative_engine/     # ðŸ§  The Narrative Engine (modular core)
â”œâ”€â”€ the-narrative-engine/ # ðŸ“¦ Standalone Narrative Engine repository
â”œâ”€â”€ solo-heart-ui/        # ðŸŽ¨ React-based UI components
â”œâ”€â”€ docs/                 # ðŸ“š Documentation
â”œâ”€â”€ tests/                # ðŸ§ª Test suite
â”œâ”€â”€ requirements.txt      # ðŸ“‹ Python dependencies
â”œâ”€â”€ setup.py             # ðŸ”§ Package configuration
â”œâ”€â”€ README.md            # ðŸ“– Project documentation
â””â”€â”€ LICENSE.txt          # âš–ï¸ MIT license
```

## SoloHeart Application (`/solo_heart/`)

**Purpose**: Main Flask application with character creation, campaign management, and narrative interface.

```
solo_heart/
â”œâ”€â”€ __init__.py          # ðŸš€ Flask app initialization
â”œâ”€â”€ simple_unified_interface.py # ðŸŽ¯ Main unified interface
â”œâ”€â”€ narrative_engine_integration.py # ðŸ”— Narrative Engine bridge
â”œâ”€â”€ ollama_llm_service.py # ðŸ¤– LLM service integration
â”œâ”€â”€ templates/           # ðŸŽ¨ HTML templates
â”‚   â”œâ”€â”€ character_creation.html
â”‚   â”œâ”€â”€ game_screen.html
â”‚   â”œâ”€â”€ narrative_focused.html
â”‚   â””â”€â”€ base.html
â”œâ”€â”€ static/              # ðŸŒ Static assets
â”‚   â”œâ”€â”€ css/
â”‚   â””â”€â”€ js/
â”œâ”€â”€ utils/               # ðŸ› ï¸ Utility functions
â”‚   â”œâ”€â”€ character_fact_extraction.py
â”‚   â””â”€â”€ __init__.py
â”œâ”€â”€ campaign_saves/      # ðŸ’¾ Campaign data storage
â”œâ”€â”€ character_saves/     # ðŸ‘¤ Character data storage
â””â”€â”€ live_inputs/         # ðŸ“ Live input testing
```

## Narrative Engine (`/narrative_engine/`)

**Purpose**: Modular, domain-agnostic narrative system with memory and LLM integration.

```
narrative_engine/
â”œâ”€â”€ __init__.py          # ðŸ“¦ Package initialization
â”œâ”€â”€ core/                # ðŸ§  Core engine components
â”‚   â”œâ”€â”€ engine_core.py   # Main orchestration engine
â”‚   â”œâ”€â”€ ai_dm_engine.py  # AI-driven narrative engine
â”‚   â””â”€â”€ ai_content_generator.py
â”œâ”€â”€ memory/              # ðŸ§  Memory management system
â”‚   â”œâ”€â”€ memory_manager.py
â”‚   â”œâ”€â”€ enhanced_memory_system.py
â”‚   â””â”€â”€ emotional_memory.py
â”œâ”€â”€ llm_interface/       # ðŸ¤– LLM provider interfaces
â”‚   â”œâ”€â”€ ollama_provider.py
â”‚   â””â”€â”€ base_provider.py
â”œâ”€â”€ context/             # ðŸ“‹ Context management
â”‚   â”œâ”€â”€ contextual_drift_guard.py
â”‚   â””â”€â”€ world_state_simulator.py
â”œâ”€â”€ journaling/          # ðŸ“ Player journal system
â”‚   â”œâ”€â”€ player_journal.py
â”‚   â””â”€â”€ journal_exporter.py
â”œâ”€â”€ shared/              # ðŸ”§ Shared types and utilities
â”‚   â”œâ”€â”€ types.py         # Core data types
â”‚   â””â”€â”€ constants.py
â”œâ”€â”€ tests/               # ðŸ§ª Engine-specific tests
â”œâ”€â”€ demos/               # ðŸŽª Demo and example scripts
â”œâ”€â”€ docs/                # ðŸ“š Engine documentation
â”œâ”€â”€ setup.py             # ðŸ”§ Package configuration
â””â”€â”€ README.md            # ðŸ“– Engine documentation
```

## The Narrative Engine Repository (`/the-narrative-engine/`)

**Purpose**: Standalone repository for The Narrative Engine, maintained separately.

```
the-narrative-engine/
â”œâ”€â”€ core/                # ðŸ§  Core engine components
â”œâ”€â”€ memory/              # ðŸ§  Memory system
â”œâ”€â”€ llm_interface/       # ðŸ¤– LLM providers
â”œâ”€â”€ context/             # ðŸ“‹ Context management
â”œâ”€â”€ journaling/          # ðŸ“ Journal system
â”œâ”€â”€ shared/              # ðŸ”§ Shared utilities
â”œâ”€â”€ tests/               # ðŸ§ª Test suite
â”œâ”€â”€ demos/               # ðŸŽª Demo scripts
â”œâ”€â”€ docs/                # ðŸ“š Documentation
â”œâ”€â”€ setup.py             # ðŸ”§ Package configuration
â””â”€â”€ README.md            # ðŸ“– Documentation
```

## SoloHeart UI (`/solo-heart-ui/`)

**Purpose**: React-based UI components for enhanced user experience.

```
solo-heart-ui/
â”œâ”€â”€ public/              # ðŸŒ Public assets
â”œâ”€â”€ src/                 # ðŸŽ¨ Source code
â”‚   â”œâ”€â”€ App.tsx          # Main application component
â”‚   â”œâ”€â”€ components/      # React components
â”‚   â”œâ”€â”€ pages/           # Page components
â”‚   â”œâ”€â”€ styles/          # Styling
â”‚   â””â”€â”€ utils/           # Utility functions
â”œâ”€â”€ package.json         # ðŸ“¦ Node.js dependencies
â””â”€â”€ README.md            # ðŸ“– UI documentation
```

## Documentation (`/docs/`)

**Purpose**: Comprehensive project documentation and guides.

```
docs/
â”œâ”€â”€ API.md               # ðŸ”Œ API documentation
â”œâ”€â”€ Game Flow.docx       # ðŸŽ® Game flow documentation
â”œâ”€â”€ Linux-commands-cheat-sheet-2023-Red-Hat-Developer.pdf
â””â”€â”€ README.md            # ðŸ“– Documentation index
```

## Test Suite (`/tests/`)

**Purpose**: Comprehensive testing for all project components.

```
tests/
â”œâ”€â”€ __init__.py          # ðŸ“¦ Test package initialization
â”œâ”€â”€ test_basic.py        # ðŸ§ª Basic functionality tests
â”œâ”€â”€ test_combat_system.py # âš”ï¸ Combat system tests
â”œâ”€â”€ test_narrative_engine_integration.py # ðŸ”— Integration tests
â””â”€â”€ manual_ui_test.md    # ðŸ“ Manual testing guide
```

## Configuration Files

### Package Management
- `requirements.txt` - Python dependencies
- `setup.py` - Package configuration and metadata
- `package.json` - Node.js dependencies (for UI)

### Development Configuration
- `.gitignore` - Git ignore patterns
- `.complianceignore` - Compliance ignore patterns
- `env.template` - Environment variables template

### Build & Deployment
- `Dockerfile` - Container configuration (if applicable)
- `docker-compose.yml` - Multi-service deployment (if applicable)

## Key Configuration Files

### Python Configuration
```python
# setup.py - Package configuration
from setuptools import setup, find_packages

setup(
    name="solo-heart",
    version="1.0.0",
    packages=find_packages(),
    install_requires=[
        "flask>=3.0.0",
        "requests>=2.31.0",
        "python-dotenv>=1.0.0",
    ],
    extras_require={
        "dev": ["pytest", "black", "flake8", "mypy"],
    }
)
```

### Flask Configuration
```python
# solo_heart/__init__.py - Flask app configuration
from flask import Flask
from pathlib import Path

def create_app():
    app = Flask(__name__)
    app.config['SECRET_KEY'] = os.environ.get('SECRET_KEY', 'default')
    app.config['CAMPAIGN_SAVES_DIR'] = Path(__file__).parent / "campaign_saves"
    return app
```

## Component Organization Patterns

### SoloHeart Application (`/solo_heart/`)
- **Unified Interface**: Single entry point for all functionality
- **Modular Integration**: Clean separation between UI and Narrative Engine
- **Template-based**: Jinja2 templates for server-side rendering
- **Static Assets**: Organized CSS and JavaScript files

### Narrative Engine (`/narrative_engine/`)
- **Modular Architecture**: Clear separation of concerns
- **Type Safety**: Comprehensive type hints throughout
- **Memory System**: Persistent narrative memory
- **LLM Integration**: Provider-agnostic LLM interface

### File Naming Conventions

### Python Files
- **snake_case**: `narrative_engine_integration.py`
- **Descriptive**: Purpose clearly indicated in name
- **Consistent prefixes**: `test_*`, `demo_*`, etc.

### Directories
- **snake_case**: `narrative_engine`, `campaign_saves`
- **Descriptive**: Clear purpose indication
- **Grouped logically**: Related components together

### Template Structure
```python
# Flask template organization
templates/
â”œâ”€â”€ base.html           # Base template with common layout
â”œâ”€â”€ character_creation.html # Character creation interface
â”œâ”€â”€ game_screen.html    # Main game interface
â””â”€â”€ narrative_focused.html # Narrative-focused interface
```

## Integration Patterns

### Narrative Engine Integration
```python
# âœ… Good: Clean integration pattern
from narrative_engine_integration import SoloHeartNarrativeEngine

class SimpleNarrativeBridge:
    def __init__(self):
        self.narrative_engine = None
        self.current_campaign_id = None
    
    def initialize_campaign(self, character_data, campaign_name=None):
        # Initialize Narrative Engine for campaign
        self.narrative_engine = SoloHeartNarrativeEngine(campaign_id=campaign_id)
        return self.narrative_engine.initialize_campaign(character_data, campaign_name)
```

### Data Flow Patterns
```python
# âœ… Good: Clear data flow
def process_player_input(self, player_input: str, campaign_id: str) -> str:
    # 1. Ensure Narrative Engine is initialized
    if not self.narrative_engine:
        self.narrative_engine = SoloHeartNarrativeEngine(campaign_id=campaign_id)
    
    # 2. Get campaign context
    campaign_context = self.get_campaign_data(campaign_id)
    
    # 3. Process through Narrative Engine
    response = self.narrative_engine.process_player_input(player_input, campaign_context)
    
    return response
```

## Best Practices

### Code Organization
- **Single Responsibility**: Each module has a clear, single purpose
- **Dependency Injection**: Use dependency injection for testability
- **Error Handling**: Comprehensive error handling throughout
- **Logging**: Structured logging for debugging and monitoring

### File Structure
- **Logical Grouping**: Related files are grouped together
- **Clear Hierarchy**: Clear parent-child relationships
- **Consistent Naming**: Consistent naming conventions throughout
- **Documentation**: Each major component has documentation
description:
globs:
alwaysApply: false
---
